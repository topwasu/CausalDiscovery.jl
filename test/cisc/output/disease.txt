 
(program
  (= GRID_SIZE 8)
  (= background "white")
  (object ObjType1 (: color String) (: field1 Int) (list (Cell 0 0 color)))

  (: addedObjType1List (List ObjType1))

  

  (= addedObjType1List (initnext (list (ObjType1  "gray"  2 (Position 1 3)) (ObjType1  "gray"  2 (Position 2 1)) (ObjType1  "gray"  2 (Position 4 4)) (ObjType1  "gray"  2 (Position 5 3)) (ObjType1  "darkgreen"  1 (Position 0 0))) (prev addedObjType1List)))
  
  


  (: time Int)
  (= time (initnext 0 (+ time 1))) 

  (on true
(= addedObjType1List (updateObj addedObjType1List (--> obj (moveDown (prev obj))) (--> obj (& down (intersects (list 1) (map (--> obj (.. obj field1)) (list (prev obj)))))))))
  (on true
(= addedObjType1List (updateObj addedObjType1List (--> obj (moveLeft (prev obj))) (--> obj (& left (intersects (list 1) (map (--> obj (.. obj field1)) (list (prev obj)))))))))
  (on true
(= addedObjType1List (updateObj addedObjType1List (--> obj (moveUp (prev obj))) (--> obj (& up (== (.. obj field1) 1))))))
  (on true
(= addedObjType1List (updateObj addedObjType1List (--> obj (updateObj (prev obj) "color" "darkgreen")) (--> obj (& (intersects (unfold (map (--> obj (adjacentObjs obj 1)) (list (prev obj)))) (filter (--> obj (== (.. obj color) "darkgreen")) (prev addedObjType1List))) (! (intersects (list "darkgreen") (map (--> obj (.. obj color)) (list (prev obj))))))))))
  (on true
(= addedObjType1List (updateObj addedObjType1List (--> obj (moveRight (prev obj))) (--> obj (& (intersects (list 1) (map (--> obj (.. obj field1)) (list (prev obj)))) right)))))
  (on clicked
(= addedObjType1List (updateObj addedObjType1List (--> obj (updateObj obj "field1" 2)) (--> obj (& clicked (! (in (objClicked click (prev addedObjType1List)) (list (prev obj)))))) )))
  (on clicked
(= addedObjType1List (updateObj addedObjType1List (--> obj (updateObj obj "field1" 1)) (--> obj (clicked (list (prev obj)))) ))))





