 
(program
  (= GRID_SIZE 16)
  (= background "white")
  (object ObjType1  (list (Cell 0 0  "blue" )))
  (object ObjType2  (list (Cell 0 0  "black" )))
  (object ObjType3  (list (Cell 0 0  "orange" )))
  (object ObjType4  (list (Cell 0 0  "red" )))

  (: addedObjType1List (List ObjType1))
  (: obj11 ObjType2)

  (: addedObjType2List (List ObjType2))
  (: addedObjType3List (List ObjType3))
  (: addedObjType4List (List ObjType4))

  (= addedObjType1List (initnext (list (ObjType1  (Position 1 1)) (ObjType1  (Position 4 1)) (ObjType1  (Position 7 1)) (ObjType1  (Position 10 1)) (ObjType1  (Position 13 1)) (ObjType1  (Position 2 3)) (ObjType1  (Position 5 3)) (ObjType1  (Position 8 3)) (ObjType1  (Position 11 3)) (ObjType1  (Position 14 3))) (prev addedObjType1List)))
  (= obj11 (initnext (ObjType2  (Position 8 15)) (prev obj11)))
  
  (= addedObjType2List (initnext (list) (prev addedObjType2List)))
  (= addedObjType3List (initnext (list) (prev addedObjType3List)))
  (= addedObjType4List (initnext (list) (prev addedObjType4List)))


  (: time Int)
  (= time (initnext 0 (+ time 1))) 

  (on true
(= addedObjType4List (updateObj addedObjType4List (--> obj (moveUp (prev obj))) (--> obj true))))
  (on true
(= addedObjType4List (removeObj addedObjType4List (--> obj (| (| (intersects (list (prev obj)) (prev addedObjType1List)) (intersects (list (prev obj)) (prev addedObjType3List))) (in 0 (map (--> obj (.. (.. obj origin) y)) (list (prev obj)))))))))
  (on left
(= obj11 (moveLeft (prev obj11))))
  (on right
(= obj11 (moveRight (prev obj11))))
  (on (intersects (prev obj11) (prev addedObjType3List))
(= obj11 (removeObj (prev obj11))))
  (on true
(= addedObjType3List (updateObj addedObjType3List (--> obj (moveDown (prev obj))) (--> obj true))))
  (on true
(= addedObjType3List (removeObj addedObjType3List (--> obj (| (intersects (list (prev obj)) (prev addedObjType4List)) (in true       (map (--> obj (! (isWithinBounds (moveDown obj)))) (list (prev obj)))))))))
  (on (| (== (% (prev time) 10) 0) (== (% (prev time) 10) 5))
(= addedObjType1List (updateObj addedObjType1List (--> obj (moveLeft (prev obj))) (--> obj true))))
  (on true
(= addedObjType1List (updateObj addedObjType1List (--> obj (moveRight (prev obj))) (--> obj (| (& (== (% (prev time) 10) 5) (in 3 (map (--> obj (.. (.. obj origin) y)) (list (prev obj))))) (& (in 1 (map (--> obj (.. (.. obj origin) y)) (list (prev obj)))) (== (% (prev time) 10) 0)))))))
  (on true
(= addedObjType1List (removeObj addedObjType1List (--> obj (intersects (list (prev obj)) (prev addedObjType4List))))))
  (on (& (.. (prev obj11) alive) up)
(= addedObjType4List (addObj addedObjType4List (ObjType4  (.. (prev obj11) origin)))))
  (on (== (% (prev time) 5) 2)
(= addedObjType3List (addObj addedObjType3List (ObjType3  (.. (uniformChoice (vcat (prev addedObjType1List) (prev addedObjType1List) (prev addedObjType1List) (prev addedObjType1List) (prev addedObjType1List) (prev addedObjType1List))) origin))))))





